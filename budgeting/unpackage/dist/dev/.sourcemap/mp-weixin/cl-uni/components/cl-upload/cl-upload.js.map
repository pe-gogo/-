{"version":3,"sources":["webpack:////Users/yaowenya/Downloads/3df42048-5dfb-4d48-ad60-5b494afda419/cl-uni/components/cl-upload/cl-upload.vue?32ae","webpack:////Users/yaowenya/Downloads/3df42048-5dfb-4d48-ad60-5b494afda419/cl-uni/components/cl-upload/cl-upload.vue?1938","webpack:////Users/yaowenya/Downloads/3df42048-5dfb-4d48-ad60-5b494afda419/cl-uni/components/cl-upload/cl-upload.vue?3c6b","webpack:////Users/yaowenya/Downloads/3df42048-5dfb-4d48-ad60-5b494afda419/cl-uni/components/cl-upload/cl-upload.vue?eb8c","uni-app:///cl-uni/components/cl-upload/cl-upload.vue"],"names":["name","props","value","sizeType","type","default","sourceType","size","imageMode","multiple","limit","action","headers","data","beforeUpload","disabled","test","autoUpload","mixins","loading","urls","index","watch","immediate","handler","val","computed","isAppend","classList","list","methods","choose","uni","count","success","res","valid","url","filePath","header","formData","fail","complete","update","remove","done"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsH;AACtH;AAC6D;AACL;;;AAGxD;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,oFAAM;AACR,EAAE,6FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAAu0B,CAAgB,uyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACoC31B;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA,gBAyBA;EACAA;EAEAC;IACA;IACAC;IACA;IACAC;MACAC;MACAC;QAAA;MAAA;IACA;IACA;IACAC;MACAF;MACAC;QAAA;MAAA;IACA;IACA;IACAE;MACAH;MACAC;QAAA;MAAA;IACA;IACA;IACAG;MACAJ;MACAC;IACA;IACA;IACAI;IACA;IACAC;MACAN;MACAC;IACA;IACA;IACAM;IACA;IACAC;IACA;IACAC;IACA;IACAb;MACAI;MACAC;IACA;IACA;IACAS;MACAV;IACA;IACA;IACAW;IACAC;MACAZ;MACAC;IACA;IACA;IACAY;MACAb;MACAC;IACA;EACA;EAEAa;EAEAL;IACA;MACAM;MACAC;MACAC;IACA;EACA;EAEAC;IACApB;MACAqB;MACAC;QACA,uCACAC,MACA,4BACAA,iCACA;MACA;IACA;IAEAL;MACA;MACA;MACA;IACA;EACA;EAEAM;IACAC;MACA;IACA;IAEAC;MACA;MAEA;QACAC;MACA;MAEA;IACA;EACA;EAEAC;IACAC;MAAA;MACA;QACA;MACA;MAEA;;MAEA;MACA;;MAEA;MACA;QACA;QACA;MACA;MAEAC;QACAC;QACA9B;QACAG;QACA4B;UACA;UACAC;YAAA;cAAA;cAAA;gBAAA;kBAAA;oBAAA;sBACA;sBACA;;sBAEA;sBAAA,KACA;wBAAA;wBAAA;sBAAA;sBAAA;sBAAA,OACA;oBAAA;sBAAAC;sBAAA,MAEAA;wBAAA;wBAAA;sBAAA;sBACA;sBAAA;oBAAA;sBAAA,KAMA;wBAAA;wBAAA;sBAAA;sBACA;sBACA;sBAAA;oBAAA;sBAIA;sBACA;wBACAJ;0BACAK;0BACAC;0BACAtC;0BACAuC;0BACAC;0BACAN;4BACA;8BAAArB;4BACA;4BACA;0BACA;0BACA4B;4BACA;0BACA;0BACAC;4BACA;0BACA;wBACA;sBACA;wBACA;wBACA;sBACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YAAA,CACA;YAAA;cAAA;YAAA;UAAA;QACA;MACA;IACA;IAEAC;MACA;QACA;MACA;QACA;MACA;MAEA;IACA;IAEAC;MACA;QACA;MACA;MAEA;MACA;IACA;IAEAC;MACA;IACA;EACA;AACA;AAAA,4B","file":"cl-uni/components/cl-upload/cl-upload.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./cl-upload.vue?vue&type=template&id=b44d28f2&\"\nvar renderjs\nimport script from \"./cl-upload.vue?vue&type=script&lang=js&\"\nexport * from \"./cl-upload.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"cl-uni/components/cl-upload/cl-upload.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cl-upload.vue?vue&type=template&id=b44d28f2&\"","var components\ntry {\n  components = {\n    clLoadingMask: function () {\n      return import(\n        /* webpackChunkName: \"cl-uni/components/cl-loading-mask/cl-loading-mask\" */ \"@/cl-uni/components/cl-loading-mask/cl-loading-mask.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cl-upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cl-upload.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"cl-upload-list\" :class=\"[classList]\">\r\n\t\t<!-- 加载框 -->\r\n\t\t<cl-loading-mask :loading=\"loading\" text=\"上传图片中\"></cl-loading-mask>\r\n\r\n\t\t<!-- 上传列表 -->\r\n\t\t<view\r\n\t\t\tclass=\"cl-upload\"\r\n\t\t\tv-for=\"(url, index) in urls\"\r\n\t\t\t:key=\"index\"\r\n\t\t\t@tap=\"choose(index)\"\r\n\t\t\t:style=\"{\r\n\t\t\t\theight: size[0],\r\n\t\t\t\twidth: size[1],\r\n\t\t\t}\"\r\n\t\t>\r\n\t\t\t<image class=\"cl-upload__target\" v-show=\"url\" :src=\"url\" :mode=\"imageMode\" />\r\n\t\t\t<text class=\"cl-upload__remove cl-icon-delete-fill\" @tap.stop=\"remove(index)\"></text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 添加按钮 -->\r\n\t\t<view\r\n\t\t\tv-if=\"isAppend\"\r\n\t\t\tclass=\"cl-upload\"\r\n\t\t\t:style=\"{\r\n\t\t\t\theight: size[0],\r\n\t\t\t\twidth: size[1],\r\n\t\t\t}\"\r\n\t\t\t@tap=\"choose()\"\r\n\t\t>\r\n\t\t\t<text class=\"cl-upload__add cl-icon-plus\"></text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { isArray, isString } from \"../../utils\";\r\nimport Form from \"../../mixins/form\";\r\n\r\n/**\r\n * upload 图片上传\r\n * @description 图片上传，支持单图和多图\r\n * @tutorial https://docs.cool-js.com/uni/components/form/upload.html\r\n * @property {String, Array} value 绑定值，图片链接\r\n * @property {String} sizeType 压缩方式，original | compressed\r\n * @property {String} sourceType 选择方式，album | camera\r\n * @property {Array} size 图片大小，默认[\"200rpx\", \"200rpx\"]\r\n * @property {String} imageMode 图片裁剪、缩放模式，默认aspectFill\r\n * @property {Boolean} multiple 是否支持多选文件\r\n * @property {Number} limit 最大允许上传个数，默认9\r\n * @property {String} action 上传的地址\r\n * @property {Object} headers 设置上传的请求头部\r\n * @property {Object} data 上传时附带的额外参数\r\n * @property {String} name 上传的文件字段名，默认file\r\n * @property {Function} beforeUpload 上传前钩子\r\n * @property {Boolean} disabled 是否禁用\r\n * @property {Boolean} autoUpload 是否自动上传\r\n * @event {Function} success 上传成功时触发，function(response)\r\n * @event {Function} error 上传失败时触发，function(error)\r\n * @event {Function} custom-upload 自定义上传时触发，function(file)\r\n * @event {Function} remove 移除时触发，function(index)\r\n * @example <cl-upload action=\"http://\" />\r\n */\r\n\r\nexport default {\r\n\tname: \"cl-upload\",\r\n\r\n\tprops: {\r\n\t\t// 绑定值，图片链接\r\n\t\tvalue: [String, Array],\r\n\t\t// 压缩方式\r\n\t\tsizeType: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [\"original\", \"compressed\"],\r\n\t\t},\r\n\t\t// 选择方式\r\n\t\tsourceType: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [\"album\", \"camera\"],\r\n\t\t},\r\n\t\t// 图片大小\r\n\t\tsize: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [\"200rpx\", \"200rpx\"],\r\n\t\t},\r\n\t\t// 图片裁剪、缩放模式\r\n\t\timageMode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"aspectFill\",\r\n\t\t},\r\n\t\t// 是否支持多选文件\r\n\t\tmultiple: Boolean,\r\n\t\t// 最大允许上传个数\r\n\t\tlimit: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 9,\r\n\t\t},\r\n\t\t// 上传的地址\r\n\t\taction: String,\r\n\t\t// 设置上传的请求头部\r\n\t\theaders: Object,\r\n\t\t// 上传时附带的额外参数\r\n\t\tdata: Object,\r\n\t\t// 上传的文件字段名\r\n\t\tname: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"file\",\r\n\t\t},\r\n\t\t// 上传前钩子\r\n\t\tbeforeUpload: {\r\n\t\t\ttype: Function,\r\n\t\t},\r\n\t\t// 是否禁用\r\n\t\tdisabled: Boolean,\r\n\t\ttest: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t},\r\n\t\t// 是否自动上传\r\n\t\tautoUpload: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true,\r\n\t\t},\r\n\t},\r\n\r\n\tmixins: [Form],\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\turls: [],\r\n\t\t\tindex: undefined,\r\n\t\t};\r\n\t},\r\n\r\n\twatch: {\r\n\t\tvalue: {\r\n\t\t\timmediate: true,\r\n\t\t\thandler(val) {\r\n\t\t\t\tthis.urls = isArray(val)\r\n\t\t\t\t\t? val\r\n\t\t\t\t\t: isString(val)\r\n\t\t\t\t\t? val.split(\",\").filter(Boolean)\r\n\t\t\t\t\t: [];\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\turls(val) {\r\n\t\t\tlet d = this.multiple ? val : val[0];\r\n\t\t\tthis.$emit(\"input\", d);\r\n\t\t\tthis.$emit(\"change\", d);\r\n\t\t},\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tisAppend() {\r\n\t\t\treturn this.urls.length < (this.multiple ? this.limit : 1);\r\n\t\t},\r\n\r\n\t\tclassList() {\r\n\t\t\tlet list = [];\r\n\r\n\t\t\tif (this.isDisabled) {\r\n\t\t\t\tlist.push(\"is-disabled\");\r\n\t\t\t}\r\n\r\n\t\t\treturn list.join(\" \");\r\n\t\t},\r\n\t},\r\n\r\n\tmethods: {\r\n\t\tchoose(index) {\r\n\t\t\tif (this.isDisabled) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.index = index;\r\n\r\n\t\t\t// 可选数量\r\n\t\t\tlet count = this.index === undefined ? this.limit - this.urls.length : 1;\r\n\r\n\t\t\t// 可选数量验证\r\n\t\t\tif (count <= 0) {\r\n\t\t\t\tthis.$emit(\"exceed\", this.urls);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount,\r\n\t\t\t\tsizeType: this.sizeType,\r\n\t\t\t\tsourceType: this.sourceType,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t// 文件信息\r\n\t\t\t\t\tres.tempFiles.forEach(async (file) => {\r\n\t\t\t\t\t\t// 进度\r\n\t\t\t\t\t\tthis.loading = true;\r\n\r\n\t\t\t\t\t\t// 上传前验证\r\n\t\t\t\t\t\tif (this.beforeUpload) {\r\n\t\t\t\t\t\t\tconst valid = await this.beforeUpload(file, index);\r\n\r\n\t\t\t\t\t\t\tif (valid === false) {\r\n\t\t\t\t\t\t\t\tthis.done();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 测试\r\n\t\t\t\t\t\tif (this.test) {\r\n\t\t\t\t\t\t\tthis.update(file.path);\r\n\t\t\t\t\t\t\tthis.done();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 自动上传\r\n\t\t\t\t\t\tif (this.autoUpload) {\r\n\t\t\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\t\t\turl: this.action,\r\n\t\t\t\t\t\t\t\tfilePath: file.path,\r\n\t\t\t\t\t\t\t\tname: this.name,\r\n\t\t\t\t\t\t\t\theader: this.headers,\r\n\t\t\t\t\t\t\t\tformData: this.data,\r\n\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\tconst { data } = JSON.parse(res.data);\r\n\t\t\t\t\t\t\t\t\tthis.update(data);\r\n\t\t\t\t\t\t\t\t\tthis.$emit(\"success\", data);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\tthis.$emit(\"error\", err);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\t\t\tthis.done();\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 自定义上传\r\n\t\t\t\t\t\t\tthis.$emit(\"custom-upload\", file);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tupdate(url) {\r\n\t\t\tif (this.index !== undefined) {\r\n\t\t\t\tthis.urls[this.index] = url;\r\n\t\t\t} else {\r\n\t\t\t\tthis.urls.push(url);\r\n\t\t\t}\r\n\r\n\t\t\tthis.done();\r\n\t\t},\r\n\r\n\t\tremove(index) {\r\n\t\t\tif (this.disabled) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.urls.splice(index, 1);\r\n\t\t\tthis.$emit(\"remove\", index);\r\n\t\t},\r\n\r\n\t\tdone() {\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n"],"sourceRoot":""}